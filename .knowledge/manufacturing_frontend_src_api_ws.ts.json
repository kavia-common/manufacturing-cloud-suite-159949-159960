{"is_source_file": true, "format": "TypeScript", "description": "This file contains TypeScript code for WebSocket communication in a manufacturing dashboard frontend. It defines types, functions for establishing WebSocket connections to dashboard and scheduler streams, React hooks for subscribing to real-time KPI data with auto-reconnect, and utility functions for normalizing incoming messages.", "external_files": ["../utils/storage"], "external_methods": ["getStoredAuth"], "published": ["KpiSnapshot", "connectDashboardWS", "useDashboardStream", "connectSchedulerWS", "useSchedulerWS"], "classes": [], "methods": [{"name": "buildWsBase", "description": "Constructs the base WebSocket URL, preferring explicit environment variable or falling back to current location protocol."}, {"name": "connectDashboardWS", "description": "Establishes a WebSocket connection to the dashboard KPI stream with specified event handlers."}, {"name": "useDashboardStream", "description": "React hook to subscribe to KPI snapshots with auto-reconnect backoff, invoking a callback on new data."}, {"name": "connectSchedulerWS", "description": "Establishes a WebSocket connection to the scheduler stream with specified event handlers and optional board ID."}, {"name": "useSchedulerWS", "description": "React hook to subscribe to scheduler board messages with auto-reconnect backoff, providing raw messages."}, {"name": "normalizeSnapshot", "description": "Normalizes raw WebSocket message data into a KPI snapshot object."}, {"name": "asNumber", "description": "Converts a value to a finite number, using a fallback if necessary."}], "calls": ["connectDashboardWS", "connectSchedulerWS", "globalThis.setTimeout", "JSON.parse"], "search-terms": ["WebSocket", "KPI stream", "React hooks", "manufacturing dashboard", "real-time KPI", "scheduler stream", "normalizeSnapshot", "auto-reconnect"], "state": 2, "file_id": 30, "knowledge_revision": 149, "git_revision": "1b000fc88f57e98443ce4b694df4012052dc1e21", "revision_history": [{"79": ""}, {"94": ""}, {"95": ""}, {"100": ""}, {"106": ""}, {"107": ""}, {"112": ""}, {"121": "40a72807b56f1cc54cf69ad75adb8e1e60e9f975"}, {"149": "1b000fc88f57e98443ce4b694df4012052dc1e21"}], "ctags": [], "filename": "manufacturing_frontend/src/api/ws.ts", "hash": "df0267453203871fd7f08cb08ad1a04f", "format-version": 4, "code-base-name": "https://github.com/kavia-common/manufacturing-cloud-suite-159949-159960.git:kavia-main"}